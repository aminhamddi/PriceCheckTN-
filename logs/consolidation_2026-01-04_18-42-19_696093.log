2026-01-04 18:42:19.699 | INFO     | __main__:__init__:53 - ğŸš€ ProductConsolidator initialized
2026-01-04 18:42:19.701 | INFO     | __main__:consolidate_all:242 - ============================================================
2026-01-04 18:42:19.702 | INFO     | __main__:consolidate_all:243 - ğŸš€ STARTING PRODUCT CONSOLIDATION
2026-01-04 18:42:19.702 | INFO     | __main__:consolidate_all:244 - ============================================================
2026-01-04 18:42:19.703 | INFO     | __main__:consolidate_all:250 - 
ğŸ“‚ STEP 1: Loading data from all sources
2026-01-04 18:42:19.704 | INFO     | __main__:consolidate_all:252 - 
--- Processing MYTEK ---
2026-01-04 18:42:19.756 | INFO     | __main__:load_latest_csv:84 - âœ… Loaded 1214 products from mytek
2026-01-04 18:42:19.762 | INFO     | __main__:standardize_columns:140 - âœ… Standardized columns for mytek
2026-01-04 18:42:19.764 | INFO     | __main__:consolidate_all:252 - 
--- Processing TUNISIANET ---
2026-01-04 18:42:19.796 | INFO     | __main__:load_latest_csv:84 - âœ… Loaded 144 products from tunisianet
2026-01-04 18:42:19.799 | INFO     | __main__:standardize_columns:140 - âœ… Standardized columns for tunisianet
2026-01-04 18:42:19.800 | INFO     | __main__:consolidate_all:252 - 
--- Processing LDLC ---
2026-01-04 18:42:19.849 | INFO     | __main__:load_latest_csv:84 - âœ… Loaded 803 products from ldlc
2026-01-04 18:42:19.851 | INFO     | __main__:standardize_columns:140 - âœ… Standardized columns for ldlc
2026-01-04 18:42:19.855 | INFO     | __main__:consolidate_all:271 - 
ğŸ”— STEP 2: Combining all sources
2026-01-04 18:42:19.865 | INFO     | __main__:consolidate_all:273 - âœ… Combined: 2161 products
2026-01-04 18:42:19.866 | INFO     | __main__:consolidate_all:276 - 
ğŸ—‘ï¸  STEP 3: Removing duplicates
2026-01-04 18:42:19.876 | INFO     | __main__:remove_duplicates:180 - ğŸ—‘ï¸  Removed 440 duplicates
2026-01-04 18:42:19.879 | INFO     | __main__:consolidate_all:280 - 
âœ… STEP 4: Validating products
2026-01-04 18:42:19.883 | INFO     | __main__:validate_products:196 - ğŸ—‘ï¸  Removed 665 invalid products
2026-01-04 18:42:19.884 | INFO     | __main__:consolidate_all:284 - 
ğŸ”§ STEP 5: Enriching products
2026-01-04 18:42:19.885 | INFO     | __main__:enrich_products:202 - ğŸ”§ Enriching products...
2026-01-04 18:42:19.906 | INFO     | __main__:enrich_products:226 -    Processed 100/1056 products
2026-01-04 18:42:19.923 | INFO     | __main__:enrich_products:226 -    Processed 200/1056 products
2026-01-04 18:42:19.946 | INFO     | __main__:enrich_products:226 -    Processed 300/1056 products
2026-01-04 18:42:19.965 | INFO     | __main__:enrich_products:226 -    Processed 400/1056 products
2026-01-04 18:42:19.983 | INFO     | __main__:enrich_products:226 -    Processed 500/1056 products
2026-01-04 18:42:20.004 | INFO     | __main__:enrich_products:226 -    Processed 600/1056 products
2026-01-04 18:42:20.031 | INFO     | __main__:enrich_products:226 -    Processed 700/1056 products
2026-01-04 18:42:20.052 | INFO     | __main__:enrich_products:226 -    Processed 800/1056 products
2026-01-04 18:42:20.080 | INFO     | __main__:enrich_products:226 -    Processed 900/1056 products
2026-01-04 18:42:20.109 | INFO     | __main__:enrich_products:226 -    Processed 1000/1056 products
2026-01-04 18:42:20.126 | INFO     | __main__:enrich_products:231 - âœ… Enrichment complete
2026-01-04 18:42:20.280 | INFO     | __main__:consolidate_all:288 - 
ğŸ†” STEP 6: Adding product IDs
2026-01-04 18:42:20.291 | INFO     | __main__:save_outputs:296 - 
ğŸ’¾ Saving outputs...
2026-01-04 18:42:20.334 | INFO     | __main__:save_outputs:302 - âœ… Saved CSV: data\final\products_unified.csv
2026-01-04 18:42:20.335 | ERROR    | __main__:main:405 - âŒ Fatal error: DataFrame columns must be unique for orient='records'.
Traceback (most recent call last):

  File "C:\Users\Ce-PC\Desktop\PriceCheckTN\pricecheck-ml\scripts\1_consolidate_products.py", line 410, in <module>
    main()
    â”” <function main at 0x00000223E30127A0>

> File "C:\Users\Ce-PC\Desktop\PriceCheckTN\pricecheck-ml\scripts\1_consolidate_products.py", line 399, in main
    consolidator.save_outputs(df_final)
    â”‚            â”‚            â””       product_id        id  ...                                     specifications           product_signature
    â”‚            â”‚              0     prod_000...
    â”‚            â”” <function ProductConsolidator.save_outputs at 0x00000223E3013560>
    â”” <__main__.ProductConsolidator object at 0x00000223E30402D0>

  File "C:\Users\Ce-PC\Desktop\PriceCheckTN\pricecheck-ml\scripts\1_consolidate_products.py", line 305, in save_outputs
    df.to_json(json_path, orient='records', force_ascii=False, indent=2)
    â”‚  â”‚       â”” WindowsPath('data/final/products_unified.json')
    â”‚  â”” <function NDFrame.to_json at 0x00000223E05BDE40>
    â””       product_id        id  ...                                     specifications           product_signature
      0     prod_000...

  File "C:\Users\Ce-PC\Desktop\PriceCheckTN\pricecheck-ml\venv311\Lib\site-packages\pandas\core\generic.py", line 2629, in to_json
    return json.to_json(
           â”‚    â”” <function to_json at 0x00000223E07BE520>
           â”” <module 'pandas.io.json' from 'C:\\Users\\Ce-PC\\Desktop\\PriceCheckTN\\pricecheck-ml\\venv311\\Lib\\site-packages\\pandas\\i...
  File "C:\Users\Ce-PC\Desktop\PriceCheckTN\pricecheck-ml\venv311\Lib\site-packages\pandas\io\json\_json.py", line 195, in to_json
    s = writer(
        â”” <class 'pandas.io.json._json.FrameWriter'>
  File "C:\Users\Ce-PC\Desktop\PriceCheckTN\pricecheck-ml\venv311\Lib\site-packages\pandas\io\json\_json.py", line 251, in __init__
    self._format_axes()
    â”‚    â”” <function FrameWriter._format_axes at 0x00000223E17ED3A0>
    â”” <pandas.io.json._json.FrameWriter object at 0x00000223E1C30750>
  File "C:\Users\Ce-PC\Desktop\PriceCheckTN\pricecheck-ml\venv311\Lib\site-packages\pandas\io\json\_json.py", line 315, in _format_axes
    raise ValueError(

ValueError: DataFrame columns must be unique for orient='records'.
